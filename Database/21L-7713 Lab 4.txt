Q1:
Select Top 1 FollowedUserName, count(*) as NoOfFollowers from Following group by FollowedUserName ORDER BY COUNT(FollowerUserName) DESC;

Q2:
SELECT TOP 1 FollowedUserName 
FROM (
  SELECT TOP 2 FollowedUserName 
  FROM Following 
  GROUP BY FollowedUserName 
  ORDER BY COUNT(FollowerUserName) DESC
) AS Temp;

Q3:
Select u.UserName from Users u where UserName Not IN(Select Distinct(t.UserName) from Tweets t)

Q4:
SELECT H.Hashtag, T.UserName, COUNT(T.Text) AS TimesUsed
FROM Hashtags H
JOIN Tweets T ON T.Text LIKE CONCAT('%', H.Hashtag, '%')
GROUP BY H.Hashtag, T.UserName;

5:
SELECT UserName 
FROM Users 
WHERE UserName NOT IN (
  SELECT UserName 
  FROM Tweets 
  WHERE Text LIKE '%#Census%'
);

6:
SELECT UserName 
FROM Users 
EXCEPT 
SELECT FollowedUserName 
FROM Following;

7:
SELECT UserName 
FROM Users 
WHERE NOT EXISTS (
  SELECT 1 
  FROM Following 
  WHERE Users.UserName = Following.FollowedUserName
);

8:
-- Most common
SELECT TOP 1 InterestID, COUNT(UserName) as UserCount 
FROM UserInterests 
GROUP BY InterestID 
ORDER BY COUNT(UserName) DESC;

-- Least common
SELECT TOP 1 InterestID, COUNT(UserName) as UserCount 
FROM UserInterests 
GROUP BY InterestID 
ORDER BY COUNT(UserName) ASC;


9:
SELECT Country, COUNT(Tweets.TweetID) AS TotalTweets 
FROM Users 
JOIN Tweets ON Users.UserName = Tweets.UserName 
GROUP BY Country 
ORDER BY Country;

10:
SELECT T.UserName
FROM Tweets T
GROUP BY T.UserName
HAVING COUNT(T.Text) > (
    SELECT AVG(TweetCount)
    FROM (
        SELECT UserName, COUNT(Text) AS TweetCount
        FROM Tweets
        GROUP BY UserName
    ) AS SubQuery
);

11:
SELECT F.FollowedUserName
FROM Following F
JOIN Users U ON F.FollowerUserName = U.UserName
WHERE U.Country = 'Pakistan'
GROUP BY F.FollowedUserName;

